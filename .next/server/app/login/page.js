(()=>{var e={};e.id=520,e.ids=[520],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13482:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var s=r(65239),n=r(48088),o=r(88170),a=r.n(o),i=r(30893),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let c={children:["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,46387)),"C:\\Users\\Charan Kosari\\Desktop\\jeevic\\jeevic-admin\\app\\login\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,58014)),"C:\\Users\\Charan Kosari\\Desktop\\jeevic\\jeevic-admin\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["C:\\Users\\Charan Kosari\\Desktop\\jeevic\\jeevic-admin\\app\\login\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},38463:(e,t,r)=>{Promise.resolve().then(r.bind(r,46387))},46055:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(31658);let n=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},46387:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Charan Kosari\\\\Desktop\\\\jeevic\\\\jeevic-admin\\\\app\\\\login\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Charan Kosari\\Desktop\\jeevic\\jeevic-admin\\app\\login\\page.tsx","default")},46501:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(60687),n=r(43210),o=r(47601),a=r(16189),i=r(48622);function l(){(0,a.useRouter)();let{isAuthenticated:e,isLoading:t,setIsAuthenticated:r,refreshAuth:l}=(0,i.A)(),[c,d]=(0,n.useState)("+91"),[u,m]=(0,n.useState)(""),[g,p]=(0,n.useState)(""),[x,h]=(0,n.useState)(!1),[f,b]=(0,n.useState)(!1),[v,y]=(0,n.useState)(""),[j,P]=(0,n.useState)(""),k=async e=>{if(e.preventDefault(),!u)return void y("Please enter your phone number");try{b(!0),y(""),P(""),localStorage.setItem("lastPhoneNumber",u);let e=o.$.getInstance(),t=await e.loginRequest(c,u);h(!0),P(t.message||"OTP sent successfully")}catch(e){console.error("Failed to send OTP:",e),y("Failed to send OTP. Please try again.")}finally{b(!1)}},w=e=>(console.log("API Response:",JSON.stringify(e,null,2)),e.access_token)?e.access_token:e.token?e.token:e.data?.access_token?e.data.access_token:null,N=(0,n.useCallback)(()=>{console.log("Login successful, handling redirection"),r&&r(!0),l&&l(),setTimeout(()=>{console.log("Navigating to home page"),window.location.href="/"},1500)},[r,l]),C=async e=>{if(e.preventDefault(),!g)return void y("Please enter the OTP");try{b(!0),y(""),P("");let e=o.$.getInstance();try{let t=await e.verifyAccountAccess(c,u,g);if(console.log("OTP Verification Response:",JSON.stringify(t,null,2)),t.message?.toLowerCase().includes("invalid otp"))throw Error("Invalid OTP. Please check and try again.");let r=w(t);if(!r)throw Error("Authentication failed: No access token received from server");try{console.log("Storing token in localStorage:",r.substring(0,10)+"..."),localStorage.removeItem("access_token"),localStorage.setItem("access_token",r);let e=localStorage.getItem("access_token");if(!e)throw Error("Failed to verify token was stored correctly");console.log("Token stored successfully, length:",e.length),P("Login successful"),o.$.getInstance(r),N()}catch(e){throw console.error("Error storing token in localStorage:",e),Error("Failed to store authentication token. Please try again.")}}catch(e){throw e}}catch(e){console.error("Failed to verify OTP:",e),e instanceof Error?y(e.message):y("Failed to verify OTP. Please try again."),p("")}finally{b(!1)}};return t?(0,s.jsx)("div",{className:"flex h-screen items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-16 h-16 border-4 border-gray-200 border-t-4 border-t-orange-500 rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-medium text-gray-700 mb-1",children:"Loading"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Checking your login status..."})]})}):(0,s.jsx)("div",{className:"flex h-screen items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8 border border-gray-100",children:[(0,s.jsxs)("div",{className:"mb-8 text-center",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("img",{src:"/logo1.svg",alt:"JEEVIC Logo",className:"h-10"})}),(0,s.jsx)("h1",{className:"text-2xl font-medium text-gray-900",children:"Admin Dashboard"}),(0,s.jsx)("p",{className:"text-gray-500 mt-2 text-sm",children:"Enter your credentials to access the dashboard"})]}),v&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-50 text-red-700 rounded-md text-sm",children:v}),j&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-green-50 text-green-700 rounded-md text-sm",children:j}),x?(0,s.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 mb-1",children:"OTP"}),(0,s.jsx)("input",{id:"otp",type:"text",placeholder:"Enter OTP",value:g,onChange:e=>p(e.target.value),maxLength:6,className:"w-full text-center text-xl placeholder:text-gray-400 text-black tracking-widest rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",required:!0}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 text-center mt-2",children:["OTP sent to ",c," ",u]})]}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-orange-500 text-white py-2 px-4 rounded-md hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition-colors text-sm font-medium",disabled:f,children:f?"Verifying...":"Verify OTP"}),(0,s.jsx)("button",{type:"button",className:"w-full text-orange-500 hover:text-orange-600 underline py-2 text-sm",onClick:()=>{h(!1),y(""),P("")},disabled:f,children:"Change Phone Number"})]}):(0,s.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("select",{value:c,onChange:e=>d(e.target.value),className:"w-28 rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 text-black focus:ring-orange-500 text-sm",children:(0,s.jsx)("option",{value:"+91",children:"+91"})}),(0,s.jsx)("input",{id:"phone",type:"tel",placeholder:"Enter phone number",value:u,onChange:e=>m(e.target.value),className:"flex-1 rounded-md border text-black placeholder:text-gray-400 border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm",required:!0})]})]}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-orange-500 text-white py-2 px-4 rounded-md hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition-colors text-sm font-medium",disabled:f,children:f?"Sending OTP...":"Send OTP"})]})]})})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79551:e=>{"use strict";e.exports=require("url")},98711:(e,t,r)=>{Promise.resolve().then(r.bind(r,46501))}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,5,658,678],()=>r(13482));module.exports=s})();