(()=>{var e={};e.id=727,e.ids=[727],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30529:(e,t,s)=>{Promise.resolve().then(s.bind(s,95912))},33873:e=>{"use strict";e.exports=require("path")},39192:(e,t,s)=>{"use strict";s.d(t,{Q:()=>i});var r=s(60687),a=s(85814),l=s.n(a),n=s(14952);function i({items:e}){return(0,r.jsx)("div",{className:"px-6 pt-3 flex items-center text-sm",children:e.map((t,s)=>(0,r.jsxs)("div",{className:"flex items-center",children:[s>0&&(0,r.jsx)(n.A,{size:16,className:"mx-2 text-black"}),(0,r.jsx)(l(),{href:"#",className:`${s===e.length-1?"text-gray-800 font-medium":"text-black hover:text-gray-700"}`,children:t})]},s))})}},46055:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(31658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66479:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d});var r=s(65239),a=s(48088),l=s(88170),n=s.n(l),i=s(30893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d={children:["",{children:["real-time",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,95912)),"C:\\Users\\chand\\OneDrive\\Desktop\\jeevic_admin\\app\\real-time\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,58014)),"C:\\Users\\chand\\OneDrive\\Desktop\\jeevic_admin\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\chand\\OneDrive\\Desktop\\jeevic_admin\\app\\real-time\\page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/real-time/page",pathname:"/real-time",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},66977:(e,t,s)=>{Promise.resolve().then(s.bind(s,80807))},79551:e=>{"use strict";e.exports=require("url")},80807:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var r=s(60687),a=s(39192),l=s(43210),n=s(81904),i=s(47601),o=s(77490);function d({bill:e,onUpdateCapacityAction:t,table:s}){let[a,d]=(0,l.useState)(!1),[c,m]=(0,l.useState)(!1),[x,u]=(0,l.useState)(!1),h=(0,l.useRef)(null),g=(0,l.useRef)(null),p=(0,l.useRef)(null),{showPopup:b}=(0,o.O)(),[j,f]=(0,l.useState)(!1);console.log("billname",e,s);let y=async(e,t)=>{u(!0);let s=localStorage.getItem("access_token");if(!s)return void u(!1);try{let r=i.$.getInstance(s);await r.updateCheckout(e,{is_checked_out:!0,payment_status:"Completed",payment_date:new Date}),await r.markBookingAsCompleted(t),b("Payment completed successfully",{type:"success"})}catch(e){console.error("Failed to complete payment:",e),b("Failed to complete payment",{type:"error"})}finally{u(!1)}},v=async()=>{if(!e?.booking_id)return void console.error("No booking ID found");f(!0);try{let t=localStorage.getItem("access_token");if(!t)throw Error("No access token found");let s=i.$.getInstance(t);await s.createUserEndCheckout(e.booking_id),b("Forced checkout completed successfully",{type:"success"})}catch(e){console.error("Failed to force checkout:",e),b("Failed to complete forced checkout",{type:"error"})}finally{f(!1)}},N=()=>{d(!a)},w=async()=>{if(!e?.booking_id)return void b("No booking found to delete",{type:"error"});if(window.confirm("Are you sure you want to delete this booking? This action cannot be undone."))try{let t=localStorage.getItem("access_token");if(!t)throw Error("No access token found");let s=i.$.getInstance(t);await s.deleteBooking(e.booking_id),b("Booking deleted successfully",{type:"success"}),d(!1)}catch(e){console.error("Failed to delete booking:",e),b("Failed to delete booking",{type:"error"})}},k=()=>{d(!1),m(!0)},_=async e=>{let t=localStorage.getItem("access_token");if(!t)return;let s=i.$.getInstance(t);try{await s.markTableAsCleaned(e),b("Table marked as cleaned",{type:"success"})}catch(e){console.error("Error marking table as cleaned:",e),b("Failed to mark table as cleaned",{type:"error"})}},C=async()=>{if(!s?.id)return void b("Table ID not found",{type:"error"});try{let e=localStorage.getItem("access_token");if(!e)return void b("Authentication required",{type:"error"});let t=i.$.getInstance(e);await t.deleteTable(s.id),d(!1),b("Table deleted successfully",{type:"success"})}catch(e){b(e instanceof Error?e.message:"Failed to delete table",{type:"error"})}},S=e=>{t(e),m(!1),b(`Table capacity updated to ${e} seats`,{type:"success"})};if(!s)return(0,r.jsx)("div",{className:"bg-gray-100 border rounded-lg overflow-hidden relative",children:(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)("p",{className:"text-gray-500 text-center",children:"No table selected"})})});let T=e?.tableId??s.table_number??"N/A";return e?(0,r.jsxs)("div",{className:"bg-gray-100 border rounded-lg overflow-hidden relative",children:[(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4 justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full mr-3 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"font-medium text-gray-800",children:["Table - ",e.tableId]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[e.items.length," items @ Rs ",e.subtotal]})]})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{ref:g,onClick:N,className:"p-2 rounded-xl cursor-pointer bg-gray-200 hover:bg-gray-300",children:(0,r.jsx)(n.A,{size:20,className:"text-black "})}),a&&(0,r.jsx)("div",{ref:h,className:"absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg z-10",children:(0,r.jsxs)("div",{className:"py-1 border rounded-md",children:[(0,r.jsxs)("button",{onClick:k,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 cursor-pointer hover:bg-gray-100",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})}),"Table Details"]}),(0,r.jsxs)("button",{onClick:w,className:"flex items-center w-full px-4 py-2 text-sm text-orange-600 cursor-pointer hover:bg-gray-100",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-orange-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Delete Booking"]}),(0,r.jsxs)("button",{onClick:C,className:"flex items-center w-full px-4 py-2 text-sm text-red-600 cursor-pointer hover:bg-gray-100",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Table"]})]})})]})]}),(0,r.jsx)("div",{className:"space-y-3 mb-4 bg-white/60 rounded-xl p-4",children:e.items.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between ",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-gray-500",children:e.name}),(0,r.jsxs)("span",{className:"text-gray-500 text-sm ml-2",children:["\xd7",e.quantity]})]}),(0,r.jsxs)("span",{className:"text-gray-700",children:["₹ ",e.price]})]},t))}),(0,r.jsxs)("div",{className:"border-t pt-3 space-y-2 p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Total"}),(0,r.jsx)("span",{className:"font-medium text-gray-700",children:e.subtotal})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("span",{className:"text-gray-500",children:["Discount ",(0,r.jsxs)("span",{className:"text-sm",children:[e.discount.percentage,"%"]})]}),(0,r.jsxs)("span",{className:"text-gray-700",children:["₹ ",e.discount.amount]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("span",{className:"text-gray-600",children:["GST ",(0,r.jsxs)("span",{className:"text-sm",children:[e.gst.percentage,"%"]})]}),(0,r.jsxs)("span",{className:"text-gray-700",children:["₹ ",e.gst.amount]})]})]}),(0,r.jsxs)("div",{className:"mt-4 bg-orange-500 text-white p-3 cursor-pointer rounded-md flex justify-between",children:[(0,r.jsx)("span",{className:"font-medium",children:"Grand Total"}),(0,r.jsxs)("span",{className:"font-medium",children:["₹ ",e.grandTotal]})]}),(0,r.jsxs)("div",{className:"mt-4 flex flex-col gap-3",children:[(0,r.jsx)("button",{onClick:v,disabled:j||!e?.booking_id,className:`py-3 w-full flex items-center justify-center rounded-md transition-colors duration-200 ${j||!e?.booking_id?"bg-gray-400 cursor-not-allowed text-white":"bg-red-500 hover:bg-red-600 text-white cursor-pointer"}`,children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing Checkout..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Force Checkout"]})}),(0,r.jsx)("button",{onClick:async()=>{await y(e.checkout_id,e.booking_id)},disabled:x,className:`py-3 w-full bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center justify-center transition-colors duration-200 ${x?"cursor-not-allowed opacity-70 bg-green-400":"cursor-pointer"}`,children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Mark as completed"]})}),(0,r.jsxs)("button",{onClick:async()=>{await _(s.id)},className:"py-3 w-full bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center justify-center transition-colors duration-200",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Mark as Cleaned"]})]})]}),c&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsx)("div",{ref:p,className:"bg-white rounded-lg w-full max-w-md mx-4",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg text-black font-medium",children:"Table Details"}),(0,r.jsx)("button",{onClick:()=>m(!1),className:"text-gray-500 cursor-pointer",children:(0,r.jsx)("svg",{className:"w-5 h-5 cursor-pointer",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Table Name"}),(0,r.jsx)("div",{className:"mt-1 text-gray-400 flex items-center justify-between",children:(0,r.jsx)("span",{children:e.tableId})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Table Capacity"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)("select",{value:s.capacity,onChange:e=>S(Number(e.target.value)),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:1,children:"1 Seat"}),(0,r.jsx)("option",{value:2,children:"2 Seats"}),(0,r.jsx)("option",{value:3,children:"3 Seats"}),(0,r.jsx)("option",{value:4,children:"4 Seats"})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Table QR"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"QR where users can order items from their table"}),(0,r.jsx)("div",{className:"flex justify-center mb-2",children:(0,r.jsx)("img",{src:s.meta_data.qr_code,alt:"QR Code",className:"border"})}),(0,r.jsxs)("button",{className:"w-full flex items-center justify-center py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),(0,r.jsx)("p",{className:"cursor-pointer",children:"Download QR"})]})]})]})]})})})]}):(0,r.jsxs)("div",{className:"bg-gray-100 border rounded-lg overflow-hidden relative",children:[(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4 justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full mr-3 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"font-medium text-gray-800",children:["Table - ",T]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No active bill"})]})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{ref:g,onClick:N,className:"p-2 rounded-xl cursor-pointer bg-gray-200 hover:bg-gray-300",children:(0,r.jsx)(n.A,{size:20,className:"text-black "})}),a&&(0,r.jsx)("div",{ref:h,className:"absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg z-10",children:(0,r.jsxs)("div",{className:"py-1 border rounded-md",children:[(0,r.jsxs)("button",{onClick:k,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 cursor-pointer hover:bg-gray-100",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})}),"Table Details"]}),e&&(0,r.jsxs)("button",{onClick:w,className:"flex items-center w-full px-4 py-2 text-sm text-orange-600 cursor-pointer hover:bg-gray-100",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-orange-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Delete Booking"]}),(0,r.jsxs)("button",{onClick:C,className:"flex items-center w-full px-4 py-2 text-sm text-red-600 cursor-pointer hover:bg-gray-100",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Table"]})]})})]})]}),(0,r.jsx)("div",{className:"flex justify-center items-center h-48 bg-white/60 rounded-xl",children:(0,r.jsx)("p",{className:"text-gray-500 text-center",children:"No bill selected"})})]}),c&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsx)("div",{ref:p,className:"bg-white rounded-lg w-full max-w-md mx-4",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg text-black font-medium",children:"Table Details"}),(0,r.jsx)("button",{onClick:()=>m(!1),className:"text-gray-500 cursor-pointer",children:(0,r.jsx)("svg",{className:"w-5 h-5 cursor-pointer",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Table Name"}),(0,r.jsx)("div",{className:"mt-1 text-gray-400 flex items-center justify-between",children:(0,r.jsx)("span",{children:T})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Table Capacity"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)("select",{value:s.capacity,onChange:e=>S(Number(e.target.value)),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:1,children:"1 Seat"}),(0,r.jsx)("option",{value:2,children:"2 Seats"}),(0,r.jsx)("option",{value:3,children:"3 Seats"}),(0,r.jsx)("option",{value:4,children:"4 Seats"})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Table QR"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"QR where users can order items from their table"}),(0,r.jsx)("div",{className:"flex justify-center mb-2",children:(0,r.jsx)("img",{src:s.meta_data.qr_code,alt:"QR Code",className:"border"})}),(0,r.jsxs)("button",{className:"w-full flex items-center justify-center py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),(0,r.jsx)("p",{className:"cursor-pointer",children:"Download QR"})]})]})]})]})})})]})}function c({statuses:e}){return(0,r.jsx)("div",{className:"flex flex-wrap gap-4 justify-center",children:e.map(e=>(0,r.jsxs)("div",{className:"flex items-center px-2 border-2 py-1 rounded-md",children:[(0,r.jsx)("span",{className:`inline-block w-3 h-3 rounded-full ${e.color} mr-2`}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:e.name})]},e.name))})}var m=s(96474),x=s(11860);function u({isOpen:e,onCloseAction:t,onAddTableAction:s}){let[a,n]=(0,l.useState)(""),[i,o]=(0,l.useState)(4),d=(0,l.useRef)(null),c=async e=>{e.preventDefault(),await s({name:a,capacity:i}),t(),n(""),o(4)};return e?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,r.jsx)("div",{ref:d,className:"bg-white rounded-lg w-full max-w-md mx-4",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg text-black font-medium",children:"Add New Table"}),(0,r.jsx)("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 cursor-pointer",children:(0,r.jsx)(x.A,{size:20})})]}),(0,r.jsx)("form",{onSubmit:c,children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Table ID"}),(0,r.jsx)("input",{type:"text",value:a,onChange:e=>n(e.target.value),placeholder:"e.g. EX09",className:"w-full px-3 py-2 border rounded-md placeholder:text-gray-400 text-gray-600 focus:outline-none focus:ring-2 focus:ring-orange-500",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seating Capacity"}),(0,r.jsxs)("select",{value:i,onChange:e=>o(Number(e.target.value)),className:"w-full px-3 py-2 border rounded-md focus:outline-none text-gray-600 focus:ring-2 focus:ring-orange-500",children:[(0,r.jsx)("option",{value:1,children:"1 Seat"}),(0,r.jsx)("option",{value:2,children:"2 Seats"}),(0,r.jsx)("option",{value:3,children:"3 Seats"}),(0,r.jsx)("option",{value:4,children:"4 Seats"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,r.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 border rounded-md cursor-pointer text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-orange-500 cursor-pointer text-white rounded-md hover:bg-orange-600",children:"Add Table"})]})]})})]})})}):null}function h({tables:e,setTables:t,tableStates:s}){let a=[{name:"Active",color:"bg-green-400"},{name:"Ready to Bill",color:"bg-orange-400"},{name:"To be Cleaned",color:"bg-red-400"},{name:"Untouched",color:"bg-gray-300"}],[n,o]=(0,l.useState)(""),[x,h]=(0,l.useState)(!1),[p,b]=(0,l.useState)({}),[j,f]=(0,l.useState)({});console.log("table status",s);let y=(e,s)=>{t(t=>t.map(t=>t.id===e?{...t,capacity:s}:t))},v=async s=>{try{let r=i.$.getInstance(),a=await r.createTable({table_number:s.name,capacity:s.capacity,meta_data:{status:"Untouched",qr_code:`https://api.qrserver.com/v1/create-qr-code/?size=240x240&data=https://dine.jeevic.com/book-table/${s.name}`}});t([...e,a.data])}catch(e){console.error("Error adding table:",e)}};return(0,r.jsxs)("div",{className:"p-4 max-w-5xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:"Floor Layout"}),(0,r.jsxs)("button",{onClick:()=>h(!0),className:"flex items-center px-3 py-2 cursor-pointer bg-gray-200 text-gray-700 rounded-md hover:bg-orange-400",children:[(0,r.jsx)(m.A,{size:18,className:"mr-1"}),"Add Table"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-[2fr,1fr] gap-4",children:[(0,r.jsx)(g,{tables:e,selectedTable:n,setSelectedTable:o,statuses:a,tableStatus:j}),(0,r.jsx)(c,{statuses:a}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"my-3 border-t pt-3 flex items-center text-sm text-gray-600",children:[(0,r.jsx)("span",{className:"mr-2",children:"Table Management"}),(0,r.jsx)("span",{className:"mx-2",children:"•"}),(0,r.jsx)("span",{className:"font-medium mr-2",children:n})]}),(0,r.jsx)(d,{bill:p[n],onUpdateCapacityAction:e=>y(n,e),table:e.find(e=>e.table_number===n)})]})]}),(0,r.jsx)(u,{isOpen:x,onCloseAction:()=>h(!1),onAddTableAction:v})]})}function g({tables:e,selectedTable:t,setSelectedTable:s,tableStatus:a}){let l=e=>{switch(e){case"Active":return"bg-green-400";case"Ready to Bill":return"bg-orange-400";case"To be Cleaned":return"bg-red-400";default:return"bg-gray-300"}},n=e=>{let t=[];return e.capacity>=1&&t.push((0,r.jsx)("div",{className:"absolute top-1/2 -left-2 transform -translate-y-1/2 w-2.5 h-14 bg-gray-100 rounded-full"},"left")),e.capacity>=2&&t.push((0,r.jsx)("div",{className:"absolute top-1/2 -right-2 transform -translate-y-1/2 w-2.5 h-14 bg-gray-100 rounded-full"},"right")),e.capacity>=3&&t.push((0,r.jsx)("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2 w-14 h-2.5 bg-gray-100 rounded-full"},"top")),e.capacity>=4&&t.push((0,r.jsx)("div",{className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-14 h-2.5 bg-gray-100 rounded-full"},"bottom")),t};return(0,r.jsx)("div",{className:"grid grid-cols-3 gap-12",children:e.map(e=>{let i=t===e.table_number;return(0,r.jsx)("div",{className:"flex items-center  justify-center relative",children:(0,r.jsxs)("div",{className:`relative w-20 h-20 ${i?"scale-110":""} transition-all m-2  duration-200`,onClick:()=>s(e.table_number),children:[n(e),(0,r.jsx)("div",{className:`
                  absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 
                  w-16 h-16 rounded-xl flex items-center justify-center
                  ${l(a[e.table_number])}
                  ${i?"border-2 border-blue-500":""}
                  cursor-pointer
                `,children:(0,r.jsx)("span",{className:"font-medium text-white text-base",children:e.table_number})})]})},e.id)})})}function p({orders:e,dishes:t,tables:s,bookings:a}){let[n,o]=(0,l.useState)("preparing"),[d,c]=(0,l.useState)([]),[m,x]=(0,l.useState)(null),[u,h]=(0,l.useState)([]),g=e=>{let t=new Date(e);return new Intl.DateTimeFormat("en-US",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit",hour12:!0}).format(t)},p=e.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>{let r=s.find(t=>t.table_number===e.table_id),a=u.find(t=>t.table_number===e.table_id),l=e.items.map((s,r)=>{let l=t.find(e=>e.id===s.dish_id),n="ready"===e.order_status?s.status:a?.items[r]?.item_status||"pending";return{dish_id:s.dish_id,item_index:r,dish_name:l?.name??"Unknown Dish",quantity:s.quantity,total:(l?.price||0)*s.quantity,instructions:s.instructions,item_status:n}}),n=l.reduce((e,t)=>e+t.total,0);return{order_id:e.id,table_id:r?.table_number??"Unknown",items:l,total:n,status:e.order_status,updated_at:e.updated_at.toString()}}),b={pending:p.filter(e=>"pending"===e.status).length,preparing:p.filter(e=>"preparing"===e.status).length,served:p.filter(e=>"served"===e.status).length,ready:p.filter(e=>"ready"===e.status).length},j=[{id:"pending",label:"New Orders",count:b.pending},{id:"preparing",label:"Preparing",count:b.preparing},{id:"served",label:"Served",count:b.served},{id:"ready",label:"Ready",count:b.ready}],f=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"",y=async t=>{x(t.order_id);let s=localStorage.getItem("access_token");if(!s){console.error("No access token found in localStorage"),x(null);return}try{let r,a=i.$.getInstance(s);switch(t.status){case"pending":r="preparing",await a.markOrderAsPreparing(t.order_id);break;case"preparing":r="served",await a.markOrderAsServed(t.order_id);break;case"served":r="ready",await a.markOrderAsReady(t.order_id);break;default:r="ready"}c(e=>e.map(e=>e.order_id===t.order_id?{...e,status:r}:e)),await new Promise(s=>{let a=setInterval(()=>{let l=e.find(e=>e.id===t.order_id);l&&l.order_status===r&&(clearInterval(a),s(!0))},500);setTimeout(()=>{clearInterval(a),s(!1)},1e4)})}catch(e){console.error("Failed to update order status:",e)}finally{x(null)}},v=e=>{switch(e){case"pending":return"Start Preparing";case"preparing":return"Mark as Served";case"served":return"Complete Order";default:return""}},N=async(e,t,s)=>{if(window.confirm("This will remove the item from the current order. Proceed?")){let t=e.items.filter((e,t)=>t!==s).map(e=>({dish_id:e.dish_id,quantity:e.quantity,status:e.item_status,instructions:e.instructions})),r=localStorage.getItem("access_token");if(!r)return void console.error("No access token found in localStorage");let a=i.$.getInstance(r);try{await a.updateOrDeleteOrder(e.order_id,{items:t})}catch(e){console.error("Failed to update order:",e)}}};return(0,r.jsxs)("div",{className:"bg-white border rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"flex border-b",children:j.map(e=>(0,r.jsxs)("button",{className:`flex-1 py-3 cursor-pointer text-center relative ${n===e.id?"text-orange-500 font-medium":"text-gray-600"}`,onClick:()=>o(e.id),children:[e.label,(0,r.jsx)("span",{className:"ml-1 bg-gray-100 text-gray-700 text-xs px-1.5 py-0.5 rounded-full",children:e.count}),n===e.id&&(0,r.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-orange-500"})]},e.id))}),(0,r.jsx)("div",{className:"p-4 space-y-4",children:0===d.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:["No ",n," orders at the moment"]}):d.map(e=>(0,r.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full mr-3 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"font-medium text-gray-800",children:["Table - ",e.table_id]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("p",{className:"text-sm text-blue-400",children:["Order #",e.order_id.substring(0,8)]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Last updated: ",g(e.updated_at)]})]})]})]})}),(0,r.jsxs)("div",{className:"space-y-3",children:[e.items.map((t,s)=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("span",{className:"text-gray-700",children:t.dish_name}),(0,r.jsxs)("span",{className:"text-gray-500 text-sm ml-2",children:["\xd7",t.quantity]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${"pending"===t.item_status?"bg-gray-100 text-gray-600":"preparing"===t.item_status?"bg-orange-100 text-orange-600":"served"===t.item_status?"bg-green-100 text-green-600":"ready"===t.item_status?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:f(t.item_status)}),"pending"===e.status&&"pending"===t.item_status&&(0,r.jsx)("button",{onClick:()=>N(e,t.dish_id,s),className:"text-red-500 mx-1",children:"Remove"})]})]}),t.instructions&&(0,r.jsxs)("p",{className:"text-sm text-gray-500 italic",children:["Note: ",t.instructions]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["₹",t.total]})]},s)),(0,r.jsxs)("div",{className:"mt-3 pt-3 border-t",children:[(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["Total: ₹",e.total]}),"ready"!==e.status&&(0,r.jsx)("div",{className:"flex gap-2 mt-2",children:(0,r.jsx)("button",{onClick:()=>y(e),disabled:m===e.order_id,className:`flex-1 ${m===e.order_id?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white py-2 px-4 rounded transition duration-200`,children:m===e.order_id?"Processing...":v(e.status)})})]})]})]})},e.order_id))})]})}var b=s(62688);let j=(0,b.A)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),f=(0,b.A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function y(){let[e,t]=(0,l.useState)(!1),[s,a]=(0,l.useState)([]),[n,o]=(0,l.useState)([]),d=(0,l.useRef)(null);(0,l.useRef)(null);let c=async e=>{try{o(t=>[...t,e]),await i.$.getInstance().deleteAssistance(e),a(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Failed to delete assistance:",e)}finally{o(t=>t.filter(t=>t!==e))}};return(0,r.jsx)("header",{className:"h-16 border-b flex items-center justify-end px-6",children:(0,r.jsx)("div",{className:"flex justify-end items-center",children:(0,r.jsxs)("div",{className:"relative",ref:d,children:[(0,r.jsxs)("button",{className:"p-2 rounded-full hover:bg-indigo-50 relative transition-colors",onClick:()=>t(!e),children:[(0,r.jsx)(j,{size:20,className:"text-indigo-600"}),s.length>0&&(0,r.jsx)("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full animate-pulse"})]}),e&&(0,r.jsx)("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-indigo-100 rounded-lg shadow-lg z-50",children:(0,r.jsx)("div",{className:"p-3 space-y-2",children:0===s.length?(0,r.jsx)("div",{className:"text-center text-gray-500 py-4",children:"No assistance requests"}):s.map(e=>(0,r.jsxs)("div",{className:"border border-indigo-100 rounded-lg p-3 bg-white hover:bg-indigo-50 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"font-medium text-indigo-900",children:["Table No: ",e.table_number]}),(0,r.jsx)("button",{className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors
                            ${n.includes(e.id)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-500 hover:bg-red-600 text-white"}`,onClick:()=>c(e.id),disabled:n.includes(e.id),children:n.includes(e.id)?(0,r.jsx)(f,{size:16,className:"animate-spin"}):"Clear"})]}),(0,r.jsx)("div",{className:"text-indigo-600 text-sm mt-1",children:"Requested Assistance"})]},e.id))})})]})})})}function v(){let[e,t]=(0,l.useState)([]),[s,n]=(0,l.useState)([]),[i,o]=(0,l.useState)([]),[d,c]=(0,l.useState)([]),[m,x]=(0,l.useState)([]),[u,g]=(0,l.useState)(!0);return u?(0,r.jsx)("div",{children:"Loading..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between ",children:[(0,r.jsx)(a.Q,{items:["Cafe","Real-Time view"]}),(0,r.jsx)(y,{})]}),(0,r.jsxs)("main",{className:"flex-1 p-6",children:[(0,r.jsx)("h2",{className:"text-lg text-gray-800 font-medium mb-4",children:"Table Management"}),(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,r.jsx)("div",{className:"lg:w-1/2 xl:w-7/12",children:(0,r.jsx)("div",{className:"bg-white border rounded-lg p-4",children:(0,r.jsx)(h,{tables:e,setTables:t,tableStates:m})})}),(0,r.jsx)("div",{className:"lg:w-1/2 xl:w-5/12 flex flex-col gap-6",children:(0,r.jsx)(p,{orders:s,tables:e,dishes:d,bookings:i})})]})]})]})}},81904:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(62688).A)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},95912:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\chand\\\\OneDrive\\\\Desktop\\\\jeevic_admin\\\\app\\\\real-time\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\chand\\OneDrive\\Desktop\\jeevic_admin\\app\\real-time\\page.tsx","default")},96474:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(62688).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447,661,658,286],()=>s(66479));module.exports=r})();