{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/chand/OneDrive/Desktop/jeevic_admin/app/reviews/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { APISDK } from \"@/libs/api\";\r\nimport { Search } from \"lucide-react\";\r\nimport { ICategory, IProduct, IReview } from \"@/libs/api\";\r\n\r\nexport default function ReviewsPage() {\r\n  const [categories, setCategories] = useState<ICategory[]>([]);\r\n  const [products, setProducts] = useState<IProduct[]>([]);\r\n  const [selectedProduct, setSelectedProduct] = useState<IProduct>();\r\n  const [reviews, setReviews] = useState<IReview[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [filteredProducts, setFilteredProducts] = useState<IProduct[]>([]);\r\n  const [filteredReviews, setFilteredReviews] = useState<IReview[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [averageRating, setAverageRating] = useState<number | null>(null);\r\n\r\n  // Fetch categories and products\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      setLoading(true);\r\n      const api = APISDK.getInstance();\r\n      const cats = await api.getAllCategories();\r\n      setCategories(cats);\r\n\r\n      // Fetch all products for all categories\r\n      let allProducts: IProduct[] = [];\r\n      for (const cat of cats) {\r\n        const prods = await api.getProductByCategoryId(cat.id);\r\n        allProducts = allProducts.concat(prods || []);\r\n      }\r\n      setProducts(allProducts);\r\n      setLoading(false);\r\n    };\r\n    fetchData();\r\n  }, []);\r\n\r\n  // Fetch reviews when product changes\r\n  useEffect(() => {\r\n    if (!selectedProduct) return;\r\n    const fetchReviewsAndAverage = async () => {\r\n      setLoading(true);\r\n      const api = APISDK.getInstance();\r\n      const revs = await api.getReviewsByProductId(selectedProduct.id);\r\n      setReviews(revs);\r\n\r\n      // Fetch average rating\r\n      try {\r\n        const avgRes = await api.averageRatingsByProductId(selectedProduct.id);\r\n        // The API returns { average_rating: number } or similar\r\n        setAverageRating(avgRes ?? null);\r\n      } catch {\r\n        setAverageRating(null);\r\n      }\r\n\r\n      setLoading(false);\r\n    };\r\n    fetchReviewsAndAverage();\r\n  }, [selectedProduct]);\r\n\r\n  // Filter products and reviews by search term\r\n  useEffect(() => {\r\n    // Filter products by name or category name\r\n    let filteredProds = products;\r\n    if (searchTerm) {\r\n      filteredProds = products.filter((product) => {\r\n        const category = categories.find((cat) => cat.id === product.category_id);\r\n        const categoryName = category ? category.name : \"\";\r\n        return (\r\n          product.name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n          categoryName?.toLowerCase().includes(searchTerm.toLowerCase())\r\n        );\r\n      });\r\n    }\r\n    setFilteredProducts(filteredProds);\r\n\r\n    // If a product is selected, filter its reviews by comment or rating\r\n    if (searchTerm && selectedProduct) {\r\n      setFilteredReviews(\r\n        reviews.filter(\r\n          (r) =>\r\n            r.comment?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            r.rating?.toString().includes(searchTerm)\r\n        )\r\n      );\r\n    } else {\r\n      setFilteredReviews(reviews);\r\n    }\r\n  }, [searchTerm, products, categories, reviews, selectedProduct]);\r\n\r\n  const handleDeleteReview = async (reviewId: string) => {\r\n    if (!window.confirm(\"Are you sure you want to delete this review?\")) return;\r\n    const api = APISDK.getInstance();\r\n    await api.deleteReviewById(reviewId);\r\n    setReviews((prev) => prev.filter((r) => r.id !== reviewId));\r\n  };\r\n\r\n  // If the selected product is not in the filtered list, deselect it\r\n  useEffect(() => {\r\n    if (selectedProduct && !filteredProducts.some((p) => p.id === selectedProduct.id)) {\r\n      setSelectedProduct(undefined);\r\n      setReviews([]);\r\n      setFilteredReviews([]);\r\n    }\r\n  }, [filteredProducts, selectedProduct]);\r\n\r\n  return (\r\n    <div className=\"p-6 bg-white min-h-screen\">\r\n      {/* Search bar */}\r\n      <div className=\"mb-6\">\r\n        <div className=\"relative\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search for a Product name, Category\"\r\n            className=\"pl-10 text-black pr-4 py-2 border border-gray-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-gray-900 w-full bg-white\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n          />\r\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" size={18} />\r\n        </div>\r\n      </div>\r\n      {/* Product selector */}\r\n      <div className=\"border-b border-gray-200 mb-4\">\r\n        <div className=\"flex space-x-6 overflow-x-auto pb-2\">\r\n          {filteredProducts.map((product) => (\r\n            <button\r\n              key={product.id}\r\n              className={`flex flex-col items-center min-w-[120px] pb-2 px-1 font-medium text-sm whitespace-nowrap transition-colors ${\r\n                selectedProduct?.id === product.id\r\n                  ? \"text-black border-b-2 border-black\"\r\n                  : \"text-gray-500 hover:text-black\"\r\n              }`}\r\n              style={{ borderRadius: \"0.5rem\", background: selectedProduct?.id === product.id ? \"#f5f5f5\" : \"transparent\" }}\r\n              onClick={() => setSelectedProduct(product)}\r\n            >\r\n              <img\r\n                src={product.image_url?.[0] || \"https://i.pinimg.com/474x/15/20/b2/1520b25e509ef0c742551f7aa06a6356.jpg\"}\r\n                alt={product.name}\r\n                className=\"w-12 h-12 object-cover rounded-full border border-gray-200 mb-1\"\r\n              />\r\n              <span className=\"truncate\">{product.name}</span>\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Product details */}\r\n      {selectedProduct && (\r\n        <div className=\"mb-6 p-4 border border-gray-200 rounded-lg bg-white\">\r\n          <div className=\"flex items-center space-x-4 mb-2\">\r\n            <img\r\n              src={selectedProduct.image_url?.[0] || \"https://i.pinimg.com/474x/15/20/b2/1520b25e509ef0c742551f7aa06a6356.jpg\"}\r\n              alt={selectedProduct.name}\r\n              className=\"w-20 h-20 object-cover rounded-lg border border-gray-200\"\r\n            />\r\n            <div>\r\n              <div className=\"text-xl font-bold text-black\">{selectedProduct.name}</div>\r\n              <div className=\"text-gray-600 mt-1\">{selectedProduct.description}</div>\r\n              <div className=\"text-black font-semibold mt-2 text-base\">\r\n                â‚¹ {selectedProduct.price?.toLocaleString()}\r\n              </div>\r\n              {averageRating !== null && (\r\n                <div className=\"mt-2 text-sm text-black\">\r\n                  Average Rating: <span className=\"font-bold\">{averageRating.toFixed(2)}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Reviews */}\r\n      <div>\r\n        <h3 className=\"text-lg font-bold mb-3 text-black\">Reviews</h3>\r\n        {loading && <div className=\"text-gray-500\">Loading...</div>}\r\n        {!loading && filteredReviews.length === 0 && (\r\n          <div className=\"text-gray-400 italic\">No reviews found.</div>\r\n        )}\r\n        <ul className=\"space-y-4\">\r\n          {filteredReviews.map((review) => (\r\n            <li\r\n              key={review.id}\r\n              className=\"border border-gray-200 rounded-lg p-4 flex justify-between items-center bg-white\"\r\n            >\r\n              <div>\r\n                <div className=\"font-semibold text-black flex items-center gap-2\">\r\n                  <span>Rating:</span>\r\n                  <span className=\"bg-gray-100 text-black px-2 py-0.5 rounded font-bold\">{review.rating}</span>\r\n                </div>\r\n                <div className=\"text-gray-800 mt-1\">{review.comment}</div>\r\n                <div className=\"text-xs text-gray-400 mt-2\">\r\n                  {new Date(review.created_at).toLocaleString()}\r\n                </div>\r\n              </div>\r\n              <button\r\n                className=\"text-red-500 hover:text-white hover:bg-red-500 border border-red-200 px-3 py-1 rounded transition-colors\"\r\n                onClick={() => handleDeleteReview(review.id)}\r\n              >\r\n                Delete\r\n              </button>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 391, "column": 0}, "map": {"version":3,"file":"search.js","sources":["file://C%3A/Users/chand/OneDrive/Desktop/jeevic_admin/node_modules/lucide-react/src/icons/search.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['circle', { cx: '11', cy: '11', r: '8', key: '4ej97u' }],\n  ['path', { d: 'm21 21-4.3-4.3', key: '1qie3q' }],\n];\n\n/**\n * @component @name Search\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMSIgY3k9IjExIiByPSI4IiAvPgogIDxwYXRoIGQ9Im0yMSAyMS00LjMtNC4zIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/search\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Search = createLucideIcon('search', __iconNode);\n\nexport default Search;\n"],"names":[],"mappings":";;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAuB,CAAA,CAAA,CAAA,CAAA;IAClC;QAAC,QAAU,CAAA;QAAA,CAAA;YAAE,EAAI,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAM,CAAI,CAAA,CAAA,CAAA,IAAA,CAAM;YAAA,CAAG,EAAA,CAAA,CAAA,CAAA,CAAA;YAAK,GAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA,CAAA;IACxD;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA;QAAA,CAAA;YAAE,GAAG,CAAkB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAA,CAAA,CAAA,CAAA,CAAA,CAAK;QAAA,CAAU;KAAA;CACjD,CAAA;AAaM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,MAAA,CAAS,CAAA,wKAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAiB,CAAjB,CAAA,AAAiB,CAAjB,AAAiB,CAAjB,AAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAU,CAAU,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA","ignoreList":[0],"debugId":null}}]
}